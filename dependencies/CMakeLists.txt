include(ExternalProject)

set(PAHO_MQTT_C_VERSION "1.3.1")
set(PAHO_MQTT_CPP_VERSION "1.1")
set(GTEST_VERSION "1.10.0")

ExternalProject_Add(pahomqttc
    GIT_REPOSITORY "https://github.com/eclipse/paho.mqtt.c"
    GIT_TAG "v${PAHO_MQTT_C_VERSION}"
    UPDATE_COMMAND ""
    CMAKE_ARGS -DPAHO_WITH_SSL=TRUE -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=${CMAKE_LIBRARY_OUTPUT_DIRECTORY} -DCMAKE_INSTALL_PREFIX=${CMAKE_PREFIX_PATH} -DCMAKE_PREFIX_PATH=${CMAKE_PREFIX_PATH} -DCMAKE_INSTALL_RPATH='.'
)

ExternalProject_Add(pahomqttcpp
    GIT_REPOSITORY "https://github.com/eclipse/paho.mqtt.cpp"
    GIT_TAG "v${PAHO_MQTT_CPP_VERSION}"
    UPDATE_COMMAND ""
    CMAKE_ARGS -DPAHO_WITH_SSL=TRUE -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=${CMAKE_LIBRARY_OUTPUT_DIRECTORY} -DCMAKE_INSTALL_PREFIX=${CMAKE_PREFIX_PATH} -DCMAKE_PREFIX_PATH=${CMAKE_PREFIX_PATH} -DPAHO_MQTT_C_INCLUDE_DIRS=${CMAKE_PREFIX_PATH}/include -DCMAKE_INSTALL_RPATH='.'
    DEPENDS pahomqttc
)

ExternalProject_Add(libgtest
    GIT_REPOSITORY "https://github.com/google/googletest"
    GIT_TAG "release-${GTEST_VERSION}"
    CMAKE_ARGS -DCMAKE_INSTALL_FULL_LIBDIR=${CMAKE_LIBRARY_OUTPUT_DIRECTORY} -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=${CMAKE_LIBRARY_OUTPUT_DIRECTORY} -DCMAKE_INSTALL_PREFIX=${CMAKE_PREFIX_PATH} -DCMAKE_PREFIX_PATH=${CMAKE_PREFIX_PATH}
    INSTALL_DIR ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}
)